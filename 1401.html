<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø¨Ø±Ù†Ø§Ù…Ù‡ Ú©Ø§Ø±Ø¢Ù…ÙˆØ²ÛŒ Û±Û´Û°Û±</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <style>
        /* --- ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ú©Ù„ÛŒ Ùˆ Ù¾Ø³â€ŒØ²Ù…ÛŒÙ†Ù‡ ØªÚ©Ù†ÛŒÚ©Ø§Ù„ --- */
        :root {
            --bg-color: #e5e5f7;
            --card-bg: rgba(255, 255, 255, 0.95);
            --text-main: #2c3e50;
            --primary: #007bff;
        }

        body { 
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            margin: 0;
            padding: 20px;
            min-height: 100vh;
            background-color: var(--bg-color);
            background-image:  radial-gradient(#444cf7 0.5px, transparent 0.5px), radial-gradient(#444cf7 0.5px, #e5e5f7 0.5px);
            background-size: 20px 20px;
            color: var(--text-main);
            transition: all 0.3s ease;
        }

        /* Ú©Ø§Ù†ØªÛŒÙ†Ø± Ø§ØµÙ„ÛŒ */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: var(--card-bg);
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.3);
        }

        /* --- Ù†ÙˆØ§Ø± Ø§Ø¨Ø²Ø§Ø± --- */
        .toolbar {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            background: white;
            padding: 15px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }

        .controls-wrapper {
            display: flex;
            gap: 10px;
            align-items: center;
            flex-grow: 1;
        }

        select, input.search-input {
            padding: 10px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-family: inherit;
            outline: none;
            transition: 0.3s;
        }
        select:focus, input.search-input:focus { border-color: var(--primary); }

        .actions { display: flex; gap: 10px; }
        
        button.tool-btn {
            padding: 10px 15px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: 0.3s;
            color: white;
        }
        .btn-home { background: #6c757d; }
        .btn-pdf { background: #dc3545; }
        .btn-dark { background: #343a40; }
        button.tool-btn:hover { transform: translateY(-2px); box-shadow: 0 5px 15px rgba(0,0,0,0.2); }

        /* --- Ø§Ø³ØªØ§ÛŒÙ„ Ø¬Ø¯ÙˆÙ„â€ŒÙ‡Ø§ --- */
        .schedule-card {
            margin-bottom: 30px;
            border: 1px solid #eee;
            border-radius: 12px;
            overflow: hidden;
        }
        
        .schedule-header {
            background: linear-gradient(135deg, #007bff, #0056b3);
            color: white;
            padding: 10px 20px;
            font-weight: bold;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .table-responsive {
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.85rem;
            white-space: nowrap;
        }

        th {
            background: #f8f9fa;
            color: #333;
            padding: 12px;
            border-bottom: 2px solid #ddd;
        }

        td {
            padding: 8px;
            text-align: center;
            border-bottom: 1px solid #eee;
        }

        tr:nth-child(even) { background-color: #fcfcfc; }
        
        /* Ø³ØªÙˆÙ† Ø§ÙˆÙ„ ÙÛŒÚ©Ø³ (ØªØ§Ø±ÛŒØ®) */
        td:first-child {
            font-weight: bold;
            background-color: #fff;
            border-left: 2px solid #eee;
            position: sticky;
            right: 0;
        }

        /* --- Ø¨Ø±Ú†Ø³Ø¨â€ŒÙ‡Ø§ÛŒ Ø±Ù†Ú¯ÛŒ Ø¨Ø®Ø´â€ŒÙ‡Ø§ --- */
        .station-badge {
            display: block;
            padding: 6px 4px;
            border-radius: 6px;
            font-size: 0.75rem;
            font-weight: bold;
            box-shadow: 0 1px 2px rgba(0,0,0,0.1);
        }

        /* Ø±Ù†Ú¯â€ŒØ¨Ù†Ø¯ÛŒ Ø¨Ø®Ø´â€ŒÙ‡Ø§ */
        .bg-blue { background: #dbeafe; color: #1e40af; }
        .bg-blue-dark { background: #bfdbfe; color: #172554; }
        .bg-green { background: #dcfce7; color: #166534; }
        .bg-green-dark { background: #bbf7d0; color: #14532d; }
        .bg-yellow { background: #fef9c3; color: #854d0e; }
        .bg-purple { background: #f3e8ff; color: #6b21a8; }
        .bg-red { background: #fee2e2; color: #991b1b; }
        .bg-gray { background: #f3f4f6; color: #1f2937; }
        .bg-off { background: #ffffff; color: #cbd5e1; border: 1px dashed #cbd5e1; box-shadow: none; }
        .bg-holiday { background: #fee2e2; color: #991b1b; padding: 10px; display: block; width: 100%; }

        /* --- Ø¬Ø¯ÙˆÙ„ Ø§Ø³Ø§Ù…ÛŒ --- */
        .names-card {
            margin-top: 40px;
            background: white;
            border-radius: 12px;
            padding: 20px;
            border: 2px dashed #ccc;
        }
        .names-card input {
            width: 90%;
            text-align: center;
            border: 1px solid #ddd;
            padding: 5px;
            border-radius: 4px;
        }

        /* --- Ø­Ø§Ù„Øª Ø´Ø¨ --- */
        body.dark-mode {
            background-color: #0f172a;
            background-image: radial-gradient(#334155 0.5px, transparent 0.5px), radial-gradient(#334155 0.5px, #0f172a 0.5px);
            --card-bg: rgba(30, 41, 59, 0.95);
            --text-main: #e2e8f0;
        }
        body.dark-mode .container { border-color: #334155; }
        body.dark-mode .toolbar, body.dark-mode .names-card { background: #1e293b; color: white; border-color: #444; }
        body.dark-mode select, body.dark-mode input { background: #0f172a; color: white; border-color: #444; }
        body.dark-mode .schedule-card { border-color: #444; }
        body.dark-mode th { background: #334155; color: white; border-bottom-color: #555; }
        body.dark-mode td { border-bottom-color: #334155; }
        body.dark-mode tr:nth-child(even) { background-color: #1a2436; }
        body.dark-mode td:first-child { background-color: #1e293b; border-left-color: #444; }
        
        /* Ø§ØµÙ„Ø§Ø­ Ø±Ù†Ú¯ Ø¨Ø¬â€ŒÙ‡Ø§ Ø¯Ø± Ø­Ø§Ù„Øª Ø´Ø¨ */
        body.dark-mode .bg-blue { background: #1e3a8a; color: #dbeafe; }
        body.dark-mode .bg-blue-dark { background: #172554; color: #bfdbfe; }
        body.dark-mode .bg-green { background: #14532d; color: #dcfce7; }
        body.dark-mode .bg-green-dark { background: #052e16; color: #bbf7d0; }
        body.dark-mode .bg-yellow { background: #713f12; color: #fef9c3; }
        body.dark-mode .bg-purple { background: #581c87; color: #f3e8ff; }
        body.dark-mode .bg-red { background: #7f1d1d; color: #fee2e2; }
        body.dark-mode .bg-gray { background: #374151; color: #f3f4f6; }
        body.dark-mode .bg-off { background: transparent; color: #64748b; border-color: #475569; }
        
        @media (max-width: 768px) {
            .toolbar { flex-direction: column; align-items: stretch; }
            .controls-wrapper { flex-direction: column; }
            select { width: 100%; }
        }
    </style>
</head>
<body>

    <div class="container" id="content-to-print">
        
        <div class="toolbar" data-html2canvas-ignore="true">
            <div class="controls-wrapper">
                <i class="fas fa-filter" style="color:#007bff"></i>
                <select id="groupSelect" onchange="renderSchedule()">
                    <option value="all">Ù†Ù…Ø§ÛŒØ´ Ù‡Ù…Ù‡ Ú¯Ø±ÙˆÙ‡â€ŒÙ‡Ø§</option>
                    <option value="1">ÙÙ‚Ø· Ú¯Ø±ÙˆÙ‡ Û±</option>
                    <option value="2">ÙÙ‚Ø· Ú¯Ø±ÙˆÙ‡ Û²</option>
                    <option value="3">ÙÙ‚Ø· Ú¯Ø±ÙˆÙ‡ Û³</option>
                    <option value="4">ÙÙ‚Ø· Ú¯Ø±ÙˆÙ‡ Û´</option>
                    <option value="5">ÙÙ‚Ø· Ú¯Ø±ÙˆÙ‡ Ûµ</option>
                    <option value="6">ÙÙ‚Ø· Ú¯Ø±ÙˆÙ‡ Û¶</option>
                    <option value="7">ÙÙ‚Ø· Ú¯Ø±ÙˆÙ‡ Û·</option>
                    <option value="8">ÙÙ‚Ø· Ú¯Ø±ÙˆÙ‡ Û¸</option>
                </select>
                <input type="text" id="searchInput" class="search-input" onkeyup="searchInPage()" placeholder="ğŸ” Ø¬Ø³ØªØ¬ÙˆÛŒ Ù…ØªÙ†...">
            </div>

            <div class="actions">
                <button onclick="toggleDarkMode()" class="tool-btn btn-dark" title="Ø­Ø§Ù„Øª Ø´Ø¨">
                    <i class="fas fa-moon"></i>
                </button>
                <button onclick="downloadPDF()" class="tool-btn btn-pdf">
                    <i class="fas fa-file-pdf"></i> PDF
                </button>
                <a href="index.html" style="text-decoration:none;">
                    <button class="tool-btn btn-home">
                        <i class="fas fa-home"></i> Ø®Ø§Ù†Ù‡
                    </button>
                </a>
            </div>
        </div>

        <div style="text-align: center; margin-bottom: 20px;">
            <h1 style="margin:0; color:var(--primary)">ğŸ“… Ø¨Ø±Ù†Ø§Ù…Ù‡ Ú©Ø§Ø±Ø¢Ù…ÙˆØ²ÛŒ Ø±Ø§Ø¯ÛŒÙˆÙ„ÙˆÚ˜ÛŒ (ÙˆØ±ÙˆØ¯ÛŒ Û±Û´Û°Û±)</h1>
        </div>

        <div id="scheduleContainer">
            </div>

        <div class="names-card">
            <div style="margin-bottom:15px; font-weight:bold; border-bottom:1px solid #eee; padding-bottom:10px;">
                <i class="fas fa-users"></i> Ø§Ø³Ø§Ù…ÛŒ Ø¯Ø§Ù†Ø´Ø¬ÙˆÛŒØ§Ù† (Ø°Ø®ÛŒØ±Ù‡ Ø®ÙˆØ¯Ú©Ø§Ø±)
            </div>
            <div class="table-responsive" id="namesTableContainer">
                </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    
    <script>
        // --- Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ (Ø¯Ø³Øª Ù†Ø®ÙˆØ±Ø¯Ù‡ Ø§Ø² Ú©Ø¯ Ù‚Ø¨Ù„ÛŒ Ø´Ù…Ø§) ---
        const stations = [
            { id: 'mri_bahonar_m', name: 'Ø¨Ø§Ù‡Ù†Ø± ØµØ¨Ø­', css: 'bg-blue' },
            { id: 'mri_bahonar_e', name: 'Ø¨Ø§Ù‡Ù†Ø± Ø¹ØµØ±', css: 'bg-blue-dark' },
            { id: 'mri_shafa_m', name: 'Ø´ÙØ§ ØµØ¨Ø­', css: 'bg-green' },
            { id: 'mri_shafa_e', name: 'Ø´ÙØ§ Ø¹ØµØ±', css: 'bg-green-dark' },
            { id: 'dentistry', name: 'Ø¯Ù†Ø¯Ø§Ù†', css: 'bg-yellow' },
            { id: 'samen', name: 'Ø«Ø§Ù…Ù†', css: 'bg-purple' },
            { id: 'afzali', name: 'Ø§ÙØ¶Ù„ÛŒ', css: 'bg-red' },
            { id: 'ultra', name: 'Ø³ÙˆÙ†Ùˆ', css: 'bg-gray' },
        ];

        const scheduleData = [
            { range: 'Û² ØªØ§ Û¶ Ø§Ø³ÙÙ†Ø¯', days: [
                { d: 'Ø´Ù†Ø¨Ù‡ Û²', a: { mri_bahonar_m: 7, mri_bahonar_e: 2, mri_shafa_m: 3, mri_shafa_e: 4, dentistry: 5, samen: 6, afzali: 1, ultra: 8 } },
                { d: 'ÛŒÚ©Ø´Ù†Ø¨Ù‡ Û³', a: { mri_bahonar_m: 7, mri_bahonar_e: 2, mri_shafa_m: 3, mri_shafa_e: 4, dentistry: 5, samen: 6, afzali: 1, ultra: 8 } },
                { d: 'Ø¯ÙˆØ´Ù†Ø¨Ù‡ Û´', a: { mri_bahonar_m: 7, mri_bahonar_e: 2, mri_shafa_m: 3, mri_shafa_e: 4, dentistry: 5, samen: 6, afzali: 1, ultra: 8 } },
                { d: 'Ø³Ù‡â€ŒØ´Ù†Ø¨Ù‡ Ûµ', a: { mri_bahonar_m: 7, mri_bahonar_e: 2, mri_shafa_m: 3, mri_shafa_e: 4, dentistry: 5, samen: 6, afzali: 1, ultra: 8 } },
                { d: 'Ú†Ù‡Ø§Ø±Ø´Ù†Ø¨Ù‡ Û¶', a: { mri_bahonar_m: 7, mri_bahonar_e: 2, mri_shafa_m: 3, mri_shafa_e: 4, dentistry: 5, samen: 6, afzali: 1, ultra: 8 } },
            ]},
            { range: 'Û¹ ØªØ§ Û±Û³ Ø§Ø³ÙÙ†Ø¯', days: [
                { d: 'Ø´Ù†Ø¨Ù‡ Û¹', a: { mri_bahonar_m: 7, mri_bahonar_e: 2, mri_shafa_m: 3, mri_shafa_e: 4, dentistry: 5, samen: 6, afzali: 1, ultra: 8 } },
                { d: 'ÛŒÚ©Ø´Ù†Ø¨Ù‡ Û±Û°', a: { mri_bahonar_m: 7, mri_bahonar_e: 2, mri_shafa_m: 3, mri_shafa_e: 4, dentistry: 5, samen: 6, afzali: 1, ultra: 8 } },
                { d: 'Ø¯ÙˆØ´Ù†Ø¨Ù‡ Û±Û±', a: { mri_bahonar_m: 7, mri_bahonar_e: 2, mri_shafa_m: 3, mri_shafa_e: 4, dentistry: 5, samen: 6, afzali: 1, ultra: 8 } },
                { d: 'Ø³Ù‡â€ŒØ´Ù†Ø¨Ù‡ Û±Û²', a: { mri_bahonar_m: 2, mri_bahonar_e: 7, mri_shafa_m: 8, mri_shafa_e: 3, dentistry: 4, samen: 5, afzali: 6, ultra: 1 } },
                { d: 'Ú†Ù‡Ø§Ø±Ø´Ù†Ø¨Ù‡ Û±Û³', a: { mri_bahonar_m: 2, mri_bahonar_e: 7, mri_shafa_m: 8, mri_shafa_e: 3, dentistry: 4, samen: 5, afzali: 6, ultra: 1 } },
            ]},
            { range: 'Û±Û¶ ØªØ§ Û²Û° Ø§Ø³ÙÙ†Ø¯', days: [
                { d: 'Ø´Ù†Ø¨Ù‡ Û±Û¶', a: { mri_bahonar_m: 2, mri_bahonar_e: 7, mri_shafa_m: 8, mri_shafa_e: 3, dentistry: 4, samen: 5, afzali: 6, ultra: 1 } },
                { d: 'ÛŒÚ©Ø´Ù†Ø¨Ù‡ Û±Û·', a: { mri_bahonar_m: 2, mri_bahonar_e: 7, mri_shafa_m: 8, mri_shafa_e: 3, dentistry: 4, samen: 5, afzali: 6, ultra: 1 } },
                { d: 'Ø¯ÙˆØ´Ù†Ø¨Ù‡ Û±Û¸', a: { mri_bahonar_m: 2, mri_bahonar_e: 7, mri_shafa_m: 8, mri_shafa_e: 3, dentistry: 4, samen: 5, afzali: 6, ultra: 1 } },
                { d: 'Ø³Ù‡â€ŒØ´Ù†Ø¨Ù‡ Û±Û¹', a: { mri_bahonar_m: 2, mri_bahonar_e: 7, mri_shafa_m: 8, mri_shafa_e: 3, dentistry: 4, samen: 5, afzali: 6, ultra: 1 } },
                { d: 'Ú†Ù‡Ø§Ø±Ø´Ù†Ø¨Ù‡ Û²Û°', holiday: true, a: {} },
            ]},
            { range: 'Û²Û³ Ùˆ Û²Û´ Ø§Ø³ÙÙ†Ø¯', days: [
                { d: 'Ø´Ù†Ø¨Ù‡ Û²Û³', a: { mri_bahonar_m: 2, mri_bahonar_e: 7, mri_shafa_m: 8, mri_shafa_e: 3, dentistry: 4, samen: 5, afzali: 6, ultra: 1 } },
                { d: 'ÛŒÚ©Ø´Ù†Ø¨Ù‡ Û²Û´', a: { mri_bahonar_m: 2, mri_bahonar_e: 7, mri_shafa_m: 8, mri_shafa_e: 3, dentistry: 4, samen: 5, afzali: 6, ultra: 1 } },
            ]},
            { range: 'Û±Ûµ ØªØ§ Û±Û¹ ÙØ±ÙˆØ±Ø¯ÛŒÙ†', days: [
                { d: 'Ø´Ù†Ø¨Ù‡ Û±Ûµ', a: { mri_bahonar_m: 1, mri_bahonar_e: 8, mri_shafa_m: 7, mri_shafa_e: 2, dentistry: 3, samen: 4, afzali: 5, ultra: 6 } },
                { d: 'ÛŒÚ©Ø´Ù†Ø¨Ù‡ Û±Û¶', a: { mri_bahonar_m: 1, mri_bahonar_e: 8, mri_shafa_m: 7, mri_shafa_e: 2, dentistry: 3, samen: 4, afzali: 5, ultra: 6 } },
                { d: 'Ø¯ÙˆØ´Ù†Ø¨Ù‡ Û±Û·', a: { mri_bahonar_m: 1, mri_bahonar_e: 8, mri_shafa_m: 7, mri_shafa_e: 2, dentistry: 3, samen: 4, afzali: 5, ultra: 6 } },
                { d: 'Ø³Ù‡â€ŒØ´Ù†Ø¨Ù‡ Û±Û¸', a: { mri_bahonar_m: 1, mri_bahonar_e: 8, mri_shafa_m: 7, mri_shafa_e: 2, dentistry: 3, samen: 4, afzali: 5, ultra: 6 } },
                { d: 'Ú†Ù‡Ø§Ø±Ø´Ù†Ø¨Ù‡ Û±Û¹', a: { mri_bahonar_m: 1, mri_bahonar_e: 8, mri_shafa_m: 7, mri_shafa_e: 2, dentistry: 3, samen: 4, afzali: 5, ultra: 6 } },
            ]},
            { range: 'Û²Û² ØªØ§ Û²Û¶ ÙØ±ÙˆØ±Ø¯ÛŒÙ†', days: [
                { d: 'Ø´Ù†Ø¨Ù‡ Û²Û²', a: { mri_bahonar_m: 1, mri_bahonar_e: 8, mri_shafa_m: 7, mri_shafa_e: 2, dentistry: 3, samen: 4, afzali: 5, ultra: 6 } },
                { d: 'ÛŒÚ©Ø´Ù†Ø¨Ù‡ Û²Û³', a: { mri_bahonar_m: 1, mri_bahonar_e: 8, mri_shafa_m: 7, mri_shafa_e: 2, dentistry: 3, samen: 4, afzali: 5, ultra: 6 } },
                { d: 'Ø¯ÙˆØ´Ù†Ø¨Ù‡ Û²Û´', holiday: true, a: {} },
                { d: 'Ø³Ù‡â€ŒØ´Ù†Ø¨Ù‡ Û²Ûµ', a: { mri_bahonar_m: 1, mri_bahonar_e: 8, mri_shafa_m: 7, mri_shafa_e: 2, dentistry: 3, samen: 4, afzali: 5, ultra: 6 } },
                { d: 'Ú†Ù‡Ø§Ø±Ø´Ù†Ø¨Ù‡ Û²Û¶', a: { mri_bahonar_m: 1, mri_bahonar_e: 8, mri_shafa_m: 7, mri_shafa_e: 2, dentistry: 3, samen: 4, afzali: 5, ultra: 6 } },
            ]},
            { range: 'Û²Û¹ ØªØ§ Û³Û± ÙØ±ÙˆØ±Ø¯ÛŒÙ†', days: [
                { d: 'Ø´Ù†Ø¨Ù‡ Û²Û¹', a: { mri_bahonar_m: 8, mri_bahonar_e: 1, mri_shafa_m: 6, mri_shafa_e: 7, dentistry: 2, samen: 3, afzali: 4, ultra: 5 } },
                { d: 'ÛŒÚ©Ø´Ù†Ø¨Ù‡ Û³Û°', a: { mri_bahonar_m: 8, mri_bahonar_e: 1, mri_shafa_m: 6, mri_shafa_e: 7, dentistry: 2, samen: 3, afzali: 4, ultra: 5 } },
                { d: 'Ø¯ÙˆØ´Ù†Ø¨Ù‡ Û³Û±', a: { mri_bahonar_m: 8, mri_bahonar_e: 1, mri_shafa_m: 6, mri_shafa_e: 7, dentistry: 2, samen: 3, afzali: 4, ultra: 5 } },
            ]},
            { range: 'Û± Ùˆ Û² Ø§Ø±Ø¯ÛŒØ¨Ù‡Ø´Øª', days: [
                { d: 'Ø³Ù‡â€ŒØ´Ù†Ø¨Ù‡ Û±', a: { mri_bahonar_m: 8, mri_bahonar_e: 1, mri_shafa_m: 6, mri_shafa_e: 7, dentistry: 2, samen: 3, afzali: 4, ultra: 5 } },
                { d: 'Ú†Ù‡Ø§Ø±Ø´Ù†Ø¨Ù‡ Û²', a: { mri_bahonar_m: 8, mri_bahonar_e: 1, mri_shafa_m: 6, mri_shafa_e: 7, dentistry: 2, samen: 3, afzali: 4, ultra: 5 } },
            ]},
            { range: 'Ûµ ØªØ§ Û¹ Ø§Ø±Ø¯ÛŒØ¨Ù‡Ø´Øª', days: [
                { d: 'Ø´Ù†Ø¨Ù‡ Ûµ', a: { mri_bahonar_m: 8, mri_bahonar_e: 1, mri_shafa_m: 6, mri_shafa_e: 7, dentistry: 2, samen: 3, afzali: 4, ultra: 5 } },
                { d: 'ÛŒÚ©Ø´Ù†Ø¨Ù‡ Û¶', a: { mri_bahonar_m: 8, mri_bahonar_e: 1, mri_shafa_m: 6, mri_shafa_e: 7, dentistry: 2, samen: 3, afzali: 4, ultra: 5 } },
                { d: 'Ø¯ÙˆØ´Ù†Ø¨Ù‡ Û·', a: { mri_bahonar_m: 8, mri_bahonar_e: 1, mri_shafa_m: 6, mri_shafa_e: 7, dentistry: 2, samen: 3, afzali: 4, ultra: 5 } },
                { d: 'Ø³Ù‡â€ŒØ´Ù†Ø¨Ù‡ Û¸', a: { mri_bahonar_m: 8, mri_bahonar_e: 1, mri_shafa_m: 6, mri_shafa_e: 7, dentistry: 2, samen: 3, afzali: 4, ultra: 5 } },
                { d: 'Ú†Ù‡Ø§Ø±Ø´Ù†Ø¨Ù‡ Û¹', a: { mri_bahonar_m: 8, mri_bahonar_e: 1, mri_shafa_m: 6, mri_shafa_e: 7, dentistry: 2, samen: 3, afzali: 4, ultra: 5 } },
            ]},
            { range: 'Û±Û² ØªØ§ Û±Û¶ Ø§Ø±Ø¯ÛŒØ¨Ù‡Ø´Øª', days: [
                { d: 'Ø´Ù†Ø¨Ù‡ Û±Û²', a: { mri_bahonar_m: 5, mri_bahonar_e: 6, mri_shafa_m: 1, mri_shafa_e: 8, dentistry: 7, samen: 2, afzali: 3, ultra: 4 } },
                { d: 'ÛŒÚ©Ø´Ù†Ø¨Ù‡ Û±Û³', a: { mri_bahonar_m: 5, mri_bahonar_e: 6, mri_shafa_m: 1, mri_shafa_e: 8, dentistry: 7, samen: 2, afzali: 3, ultra: 4 } },
                { d: 'Ø¯ÙˆØ´Ù†Ø¨Ù‡ Û±Û´', a: { mri_bahonar_m: 5, mri_bahonar_e: 6, mri_shafa_m: 1, mri_shafa_e: 8, dentistry: 7, samen: 2, afzali: 3, ultra: 4 } },
                { d: 'Ø³Ù‡â€ŒØ´Ù†Ø¨Ù‡ Û±Ûµ', a: { mri_bahonar_m: 5, mri_bahonar_e: 6, mri_shafa_m: 1, mri_shafa_e: 8, dentistry: 7, samen: 2, afzali: 3, ultra: 4 } },
                { d: 'Ú†Ù‡Ø§Ø±Ø´Ù†Ø¨Ù‡ Û±Û¶', a: { mri_bahonar_m: 5, mri_bahonar_e: 6, mri_shafa_m: 1, mri_shafa_e: 8, dentistry: 7, samen: 2, afzali: 3, ultra: 4 } },
            ]},
            { range: 'Û±Û¹ ØªØ§ Û²Û³ Ø§Ø±Ø¯ÛŒØ¨Ù‡Ø´Øª', days: [
                { d: 'Ø´Ù†Ø¨Ù‡ Û±Û¹', a: { mri_bahonar_m: 5, mri_bahonar_e: 6, mri_shafa_m: 1, mri_shafa_e: 8, dentistry: 7, samen: 2, afzali: 3, ultra: 4 } },
                { d: 'ÛŒÚ©Ø´Ù†Ø¨Ù‡ Û²Û°', a: { mri_bahonar_m: 5, mri_bahonar_e: 6, mri_shafa_m: 1, mri_shafa_e: 8, dentistry: 7, samen: 2, afzali: 3, ultra: 4 } },
                { d: 'Ø¯ÙˆØ´Ù†Ø¨Ù‡ Û²Û±', a: { mri_bahonar_m: 5, mri_bahonar_e: 6, mri_shafa_m: 1, mri_shafa_e: 8, dentistry: 7, samen: 2, afzali: 3, ultra: 4 } },
                { d: 'Ø³Ù‡â€ŒØ´Ù†Ø¨Ù‡ Û²Û²', a: { mri_bahonar_m: 5, mri_bahonar_e: 6, mri_shafa_m: 1, mri_shafa_e: 8, dentistry: 7, samen: 2, afzali: 3, ultra: 4 } },
                { d: 'Ú†Ù‡Ø§Ø±Ø´Ù†Ø¨Ù‡ Û²Û³', a: { mri_bahonar_m: 5, mri_bahonar_e: 6, mri_shafa_m: 1, mri_shafa_e: 8, dentistry: 7, samen: 2, afzali: 3, ultra: 4 } },
            ]},
            { range: 'Û²Û¶ ØªØ§ Û³Û° Ø§Ø±Ø¯ÛŒØ¨Ù‡Ø´Øª', days: [
                { d: 'Ø´Ù†Ø¨Ù‡ Û²Û¶', a: { mri_bahonar_m: 6, mri_bahonar_e: 5, mri_shafa_m: 4, mri_shafa_e: 1, dentistry: 8, samen: 7, afzali: 2, ultra: 3 } },
                { d: 'ÛŒÚ©Ø´Ù†Ø¨Ù‡ Û²Û·', a: { mri_bahonar_m: 6, mri_bahonar_e: 5, mri_shafa_m: 4, mri_shafa_e: 1, dentistry: 8, samen: 7, afzali: 2, ultra: 3 } },
                { d: 'Ø¯ÙˆØ´Ù†Ø¨Ù‡ Û²Û¸', a: { mri_bahonar_m: 6, mri_bahonar_e: 5, mri_shafa_m: 4, mri_shafa_e: 1, dentistry: 8, samen: 7, afzali: 2, ultra: 3 } },
                { d: 'Ø³Ù‡â€ŒØ´Ù†Ø¨Ù‡ Û²Û¹', a: { mri_bahonar_m: 6, mri_bahonar_e: 5, mri_shafa_m: 4, mri_shafa_e: 1, dentistry: 8, samen: 7, afzali: 2, ultra: 3 } },
                { d: 'Ú†Ù‡Ø§Ø±Ø´Ù†Ø¨Ù‡ Û³Û°', a: { mri_bahonar_m: 6, mri_bahonar_e: 5, mri_shafa_m: 4, mri_shafa_e: 1, dentistry: 8, samen: 7, afzali: 2, ultra: 3 } },
            ]},
            { range: 'Û² ØªØ§ Û¶ Ø®Ø±Ø¯Ø§Ø¯', days: [
                { d: 'Ø´Ù†Ø¨Ù‡ Û²', a: { mri_bahonar_m: 6, mri_bahonar_e: 5, mri_shafa_m: 4, mri_shafa_e: 1, dentistry: 8, samen: 7, afzali: 2, ultra: 3 } },
                { d: 'ÛŒÚ©Ø´Ù†Ø¨Ù‡ Û³', a: { mri_bahonar_m: 6, mri_bahonar_e: 5, mri_shafa_m: 4, mri_shafa_e: 1, dentistry: 8, samen: 7, afzali: 2, ultra: 3 } },
                { d: 'Ø¯ÙˆØ´Ù†Ø¨Ù‡ Û´', a: { mri_bahonar_m: 6, mri_bahonar_e: 5, mri_shafa_m: 4, mri_shafa_e: 1, dentistry: 8, samen: 7, afzali: 2, ultra: 3 } },
                { d: 'Ø³Ù‡â€ŒØ´Ù†Ø¨Ù‡ Ûµ', holiday: true, a: {} },
                { d: 'Ú†Ù‡Ø§Ø±Ø´Ù†Ø¨Ù‡ Û¶', holiday: true, a: {} },
            ]},
            { range: 'Û¹ ØªØ§ Û±Û³ Ø®Ø±Ø¯Ø§Ø¯', days: [
                { d: 'Ø´Ù†Ø¨Ù‡ Û¹', a: { mri_bahonar_m: 3, mri_bahonar_e: 4, mri_shafa_m: 5, mri_shafa_e: 6, dentistry: 1, samen: 8, afzali: 7, ultra: 2 } },
                { d: 'ÛŒÚ©Ø´Ù†Ø¨Ù‡ Û±Û°', a: { mri_bahonar_m: 3, mri_bahonar_e: 4, mri_shafa_m: 5, mri_shafa_e: 6, dentistry: 1, samen: 8, afzali: 7, ultra: 2 } },
                { d: 'Ø¯ÙˆØ´Ù†Ø¨Ù‡ Û±Û±', a: { mri_bahonar_m: 3, mri_bahonar_e: 4, mri_shafa_m: 5, mri_shafa_e: 6, dentistry: 1, samen: 8, afzali: 7, ultra: 2 } },
                { d: 'Ø³Ù‡â€ŒØ´Ù†Ø¨Ù‡ Û±Û²', a: { mri_bahonar_m: 3, mri_bahonar_e: 4, mri_shafa_m: 5, mri_shafa_e: 6, dentistry: 1, samen: 8, afzali: 7, ultra: 2 } },
                { d: 'Ú†Ù‡Ø§Ø±Ø´Ù†Ø¨Ù‡ Û±Û³', a: { mri_bahonar_m: 3, mri_bahonar_e: 4, mri_shafa_m: 5, mri_shafa_e: 6, dentistry: 1, samen: 8, afzali: 7, ultra: 2 } },
            ]},
            { range: 'Û±Û¶ ØªØ§ Û²Û° Ø®Ø±Ø¯Ø§Ø¯', days: [
                { d: 'Ø´Ù†Ø¨Ù‡ Û±Û¶', a: { mri_bahonar_m: 3, mri_bahonar_e: 4, mri_shafa_m: 5, mri_shafa_e: 6, dentistry: 1, samen: 8, afzali: 7, ultra: 2 } },
                { d: 'ÛŒÚ©Ø´Ù†Ø¨Ù‡ Û±Û·', a: { mri_bahonar_m: 3, mri_bahonar_e: 4, mri_shafa_m: 5, mri_shafa_e: 6, dentistry: 1, samen: 8, afzali: 7, ultra: 2 } },
                { d: 'Ø¯ÙˆØ´Ù†Ø¨Ù‡ Û±Û¸', a: { mri_bahonar_m: 3, mri_bahonar_e: 4, mri_shafa_m: 5, mri_shafa_e: 6, dentistry: 1, samen: 8, afzali: 7, ultra: 2 } },
                { d: 'Ø³Ù‡â€ŒØ´Ù†Ø¨Ù‡ Û±Û¹', a: { mri_bahonar_m: 3, mri_bahonar_e: 4, mri_shafa_m: 5, mri_shafa_e: 6, dentistry: 1, samen: 8, afzali: 7, ultra: 2 } },
                { d: 'Ú†Ù‡Ø§Ø±Ø´Ù†Ø¨Ù‡ Û²Û°', a: { mri_bahonar_m: 3, mri_bahonar_e: 4, mri_shafa_m: 5, mri_shafa_e: 6, dentistry: 1, samen: 8, afzali: 7, ultra: 2 } },
            ]},
            { range: 'Û²Û³ ØªØ§ Û²Û· Ø®Ø±Ø¯Ø§Ø¯', days: [
                { d: 'Ø´Ù†Ø¨Ù‡ Û²Û³', a: { mri_bahonar_m: 4, mri_bahonar_e: 3, mri_shafa_m: 2, mri_shafa_e: 5, dentistry: 6, samen: 1, afzali: 8, ultra: 7 } },
                { d: 'ÛŒÚ©Ø´Ù†Ø¨Ù‡ Û²Û´', a: { mri_bahonar_m: 4, mri_bahonar_e: 3, mri_shafa_m: 2, mri_shafa_e: 5, dentistry: 6, samen: 1, afzali: 8, ultra: 7 } },
                { d: 'Ø¯ÙˆØ´Ù†Ø¨Ù‡ Û²Ûµ', a: { mri_bahonar_m: 4, mri_bahonar_e: 3, mri_shafa_m: 2, mri_shafa_e: 5, dentistry: 6, samen: 1, afzali: 8, ultra: 7 } },
                { d: 'Ø³Ù‡â€ŒØ´Ù†Ø¨Ù‡ Û²Û¶', a: { mri_bahonar_m: 4, mri_bahonar_e: 3, mri_shafa_m: 2, mri_shafa_e: 5, dentistry: 6, samen: 1, afzali: 8, ultra: 7 } },
                { d: 'Ú†Ù‡Ø§Ø±Ø´Ù†Ø¨Ù‡ Û²Û·', a: { mri_bahonar_m: 4, mri_bahonar_e: 3, mri_shafa_m: 2, mri_shafa_e: 5, dentistry: 6, samen: 1, afzali: 8, ultra: 7 } },
            ]},
            { range: 'Û³Û° Ùˆ Û³Û± Ø®Ø±Ø¯Ø§Ø¯', days: [
                { d: 'Ø´Ù†Ø¨Ù‡ Û³Û°', a: { mri_bahonar_m: 4, mri_bahonar_e: 3, mri_shafa_m: 2, mri_shafa_e: 5, dentistry: 6, samen: 1, afzali: 8, ultra: 7 } },
                { d: 'ÛŒÚ©Ø´Ù†Ø¨Ù‡ Û³Û±', a: { mri_bahonar_m: 4, mri_bahonar_e: 3, mri_shafa_m: 2, mri_shafa_e: 5, dentistry: 6, samen: 1, afzali: 8, ultra: 7 } },
            ]},
            { range: 'Û± ØªØ§ Û³ ØªÛŒØ±', days: [
                { d: 'Ø¯ÙˆØ´Ù†Ø¨Ù‡ Û±', a: { mri_bahonar_m: 4, mri_bahonar_e: 3, mri_shafa_m: 2, mri_shafa_e: 5, dentistry: 6, samen: 1, afzali: 8, ultra: 7 } },
                { d: 'Ø³Ù‡â€ŒØ´Ù†Ø¨Ù‡ Û²', a: { mri_bahonar_m: 4, mri_bahonar_e: 3, mri_shafa_m: 2, mri_shafa_e: 5, dentistry: 6, samen: 1, afzali: 8, ultra: 7 } },
                { d: 'Ú†Ù‡Ø§Ø±Ø´Ù†Ø¨Ù‡ Û³', a: { mri_bahonar_m: 4, mri_bahonar_e: 3, mri_shafa_m: 2, mri_shafa_e: 5, dentistry: 6, samen: 1, afzali: 8, ultra: 7 } },
            ]},
        ];

        // --- ØªÙˆØ§Ø¨Ø¹ Ø§Ø¬Ø±Ø§ÛŒÛŒ ---

        function findStationForGroup(dayAssignments, groupNum) {
            if (!dayAssignments) return null;
            const stationId = Object.keys(dayAssignments).find(key => dayAssignments[key] == groupNum);
            return stations.find(s => s.id === stationId);
        }

        function renderSchedule() {
            const selectedGroup = document.getElementById('groupSelect').value;
            const container = document.getElementById('scheduleContainer');
            container.innerHTML = '';

            scheduleData.forEach(week => {
                const card = document.createElement('div');
                card.className = 'schedule-card'; // Ú©Ù„Ø§Ø³ Ø¬Ø¯ÛŒØ¯
                
                let tableHeader = '';
                if (selectedGroup === 'all') {
                    tableHeader = `<th>Ú¯ Û±</th><th>Ú¯ Û²</th><th>Ú¯ Û³</th><th>Ú¯ Û´</th><th>Ú¯ Ûµ</th><th>Ú¯ Û¶</th><th>Ú¯ Û·</th><th>Ú¯ Û¸</th>`;
                } else {
                    tableHeader = `<th>Ù…Ø­Ù„ Ú©Ø§Ø±Ø¢Ù…ÙˆØ²ÛŒ Ú¯Ø±ÙˆÙ‡ ${selectedGroup}</th>`;
                }

                let tableRows = '';
                week.days.forEach(day => {
                    let rowContent = '';
                    
                    if (day.holiday) {
                        const colSpan = selectedGroup === 'all' ? 8 : 1;
                        rowContent = `<td colspan="${colSpan}"><span class="bg-holiday">â›” ØªØ¹Ø·ÛŒÙ„</span></td>`;
                    } else {
                        if (selectedGroup === 'all') {
                            for (let g = 1; g <= 8; g++) {
                                const station = findStationForGroup(day.a, g);
                                if (station) {
                                    rowContent += `<td><span class="station-badge ${station.css}">${station.name}</span></td>`;
                                } else {
                                    rowContent += `<td><span class="station-badge bg-off">-</span></td>`;
                                }
                            }
                        } else {
                            const myStation = findStationForGroup(day.a, selectedGroup);
                            if (myStation) {
                                rowContent = `<td><span class="station-badge ${myStation.css}" style="font-size:0.95rem; padding:8px 12px;">${myStation.name}</span></td>`;
                            } else {
                                rowContent = `<td><span style="color:#94a3b8">Ø¢Ù / ØªØ¹Ø·ÛŒÙ„</span></td>`;
                            }
                        }
                    }

                    tableRows += `
                        <tr>
                            <td>${day.d}</td>
                            ${rowContent}
                        </tr>
                    `;
                });

                card.innerHTML = `
                    <div class="schedule-header">
                        <span><i class="far fa-calendar-alt"></i> ${week.range}</span>
                    </div>
                    <div class="table-wrapper">
                        <table>
                            <thead>
                                <tr>
                                    <th>Ø±ÙˆØ²</th>
                                    ${tableHeader}
                                </tr>
                            </thead>
                            <tbody>
                                ${tableRows}
                            </tbody>
                        </table>
                    </div>
                `;
                container.appendChild(card);
            });
        }

        // --- Ø¨Ø®Ø´ Ø§Ø³Ø§Ù…ÛŒ ---
        const hardcodedGroups = [
            { id: 1, label: 'Ú¯Ø±ÙˆÙ‡ Û±', members: ['Ø¹Ù„ÛŒ Ù…Ø­Ù…Ø¯ Ù…Ø±ÙˆÛŒ', 'Ø§Ù…ÛŒØ±Ø­Ø³ÛŒÙ† Ù…ÙˆØ³ÛŒ Ù¾ÙˆØ±', 'Ø±Ø²ÛŒØªØ§ Ø³Ø±Ø§ÙˆØ§Ù†ÛŒ'] },
            { id: 2, label: 'Ú¯Ø±ÙˆÙ‡ Û²', members: ['ÙØ§Ø·Ù…Ù‡ Ø¹Ø¨Ø§Ø³ÛŒ', 'Ø¢Ø°ÛŒÙ† Ø¨Ù‡Ø±Ø§Ù…ÛŒ', 'Ø²Ù‡Ø±Ø§ Ø´Ø±ÙØ¹Ù„ÛŒ Ù¾ÙˆØ±'] },
            { id: 3, label: 'Ú¯Ø±ÙˆÙ‡ Û³', members: ['Ø§Ù…ÛŒØ±Ø­Ø³ÛŒÙ† Ø®Ù„ÛŒÙ„ ÛŒØ²Ø¯ÛŒ', 'Ú©ÙˆØ«Ø± Ú¯Ù„Ø³ØªØ§Ù†ÛŒ', 'ÙØ§Ø¯ÛŒØ§ Ø®Ø§Ù„Ù‚ÛŒ'] },
            { id: 4, label: 'Ú¯Ø±ÙˆÙ‡ Û´', members: ['Ú©ÛŒØ§Ù†Ø§ Ø¬ÙˆØ§Ø¯ÛŒ', 'Ù†ÛŒÙ„ÙˆÙØ± Ø­ØµÛŒØ¨ÛŒ', 'Ù…Ø­Ù…Ø¯ Ù…Ù‡Ø¯ÛŒ Ø¨Ù‡Ø²Ø§Ø¯ÛŒ'] },
            { id: 5, label: 'Ú¯Ø±ÙˆÙ‡ Ûµ', members: ['Ú©ÛŒÙ…ÛŒØ§ Ø¹Ø³Ú©Ø±ÛŒ', 'Ù†Ø±Ø¬Ø³ Ø§Ù†Ø§Ø±ÛŒ', 'Ù…ÛŒØªØ±Ø§ Ù†Ø¬ÙÛŒ'] },
            { id: 6, label: 'Ú¯Ø±ÙˆÙ‡ Û¶', members: ['Ù†Ø¬Ù…Ù‡ Ø­Ø³ÛŒÙ†ÛŒ', 'Ø­Ø³ÛŒÙ† Ú©Ø§Ù‡Ù†ÛŒ', 'ÙØ§Ø·Ù…Ù‡ Ù‡Ø§Ø´Ù…ÛŒ'] },
            { id: 7, label: 'Ú¯Ø±ÙˆÙ‡ Û·', members: ['Ù…Ø­Ù…Ø¯Ù…Ù‡Ø¯ÛŒ Ø­ÛŒØ¯Ø±ÛŒ', 'Ø¹Ù„ÛŒ Ø³Ù„ÛŒÙ…Ø§Ù†ÛŒ', ''] },
            { id: 8, label: 'Ú¯Ø±ÙˆÙ‡ Û¸', members: ['Ø¹Ù„ÛŒØ±Ø¶Ø§ Ø¯Ú˜Ø§Ù†Ú©Ø§Ù‡', 'Ø¹Ù„ÛŒ Ø¹Ø¨Ø§Ø³ÛŒ', ''] },
        ];

        const STORAGE_KEY = 'radiologyGroups_final_v1';
        let studentGroups = JSON.parse(localStorage.getItem(STORAGE_KEY)) || hardcodedGroups;

        function renderNamesTable() {
            const container = document.getElementById('namesTableContainer');
            let html = `<table><thead><tr><th style="min-width:50px">Ø±Ø¯ÛŒÙ</th>`;
            studentGroups.forEach(g => { html += `<th style="min-width:100px">${g.label}</th>`; });
            html += `</tr></thead><tbody>`;

            [0, 1, 2].forEach(idx => {
                html += `<tr><td style="font-weight:bold">Ù†ÙØ± ${idx === 0 ? 'Ø§ÙˆÙ„' : idx === 1 ? 'Ø¯ÙˆÙ…' : 'Ø³ÙˆÙ…'}</td>`;
                studentGroups.forEach(g => {
                    html += `<td><input type="text" value="${g.members[idx] || ''}" oninput="updateMember(${g.id}, ${idx}, this.value)"></td>`;
                });
                html += `</tr>`;
            });
            html += `</tbody></table>`;
            container.innerHTML = html;
        }

        window.updateMember = function(groupId, memberIndex, value) {
            const group = studentGroups.find(g => g.id === groupId);
            if (group) {
                group.members[memberIndex] = value;
                localStorage.setItem(STORAGE_KEY, JSON.stringify(studentGroups));
            }
        };

        // --- Ø¹Ù…Ù„Ú©Ø±Ø¯ Ø¬Ø³ØªØ¬Ùˆ ---
        function searchInPage() {
            const input = document.getElementById("searchInput");
            const filter = input.value.toUpperCase();
            const cards = document.getElementsByClassName("schedule-card");
            
            // Ø¬Ø³ØªØ¬Ùˆ Ø¯Ø± Ø¬Ø¯ÙˆÙ„ Ø¨Ø±Ù†Ø§Ù…Ù‡
            for (let i = 0; i < cards.length; i++) {
                const card = cards[i];
                const text = card.innerText || card.textContent;
                if (text.toUpperCase().indexOf(filter) > -1) {
                    card.style.display = "";
                } else {
                    card.style.display = "none";
                }
            }
        }

        // --- Ø­Ø§Ù„Øª Ø´Ø¨ ---
        function toggleDarkMode() {
            document.body.classList.toggle("dark-mode");
            localStorage.setItem("theme", document.body.classList.contains("dark-mode") ? "dark" : "light");
        }
        if(localStorage.getItem("theme") == "dark") document.body.classList.add("dark-mode");

        // --- Ø¯Ø§Ù†Ù„ÙˆØ¯ PDF ---
        function downloadPDF() {
            const element = document.getElementById('content-to-print');
            const opt = {
                margin: 0.2,
                filename: 'Radiology_Schedule_1401.pdf',
                image: { type: 'jpeg', quality: 0.98 },
                html2canvas: { scale: 2 },
                jsPDF: { unit: 'in', format: 'a4', orientation: 'landscape' }
            };
            html2pdf().set(opt).from(element).save();
        }

        // Ø§Ø¬Ø±Ø§
        renderSchedule();
        renderNamesTable();
    </script>

</body>
</html>
